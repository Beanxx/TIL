[TIL] Day25 <br/>
[SEB FE] Day25

## â˜‘ï¸Â Node.js

> ë¹„ë™ê¸° ì´ë²¤íŠ¸ ê¸°ë°˜ JS ëŸ°íƒ€ì„

### ğŸ“Â Node.js ë‚´ì¥ ëª¨ë“ˆ(built-in module)

- `fs.readFile`: ë¡œì»¬ì— ì¡´ì¬í•˜ëŠ” íŒŒì¼ì˜ ë‚´ìš© ì „ì²´ë¥¼ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì½ì–´ì˜´

  - ì „ë‹¬ì¸ì 3ê°œë¥¼ ë°›ìŒ (`path`[, `options`], `callback`)
    - `path`: íŒŒì¼ ì´ë¦„ (4ê°€ì§€ íƒ€ì… ê°€ëŠ¥ - `<string>` | `<Buffer>` | `<URL>` | `<integer>`
      ```jsx
      fs.readFile('/etc/passwd', ..., ...)
      ```
    - `options`: ë„£ì„ ìˆ˜ë„, ë„£ì§€ ì•Šì„ ìˆ˜ë„ ìˆìŒ (`ë¬¸ìì—´` | `ê°ì²´` í˜•íƒœ ê°€ëŠ¥)
      - ë¬¸ìì—´ë¡œ ì „ë‹¬í•  ê²½ìš° ì¸ì½”ë”©ì„ ë°›ìŒ
        ```jsx
        let options ={
        	encoding: 'utf-8',  // utf-8 ì¸ì½”ë”© ë°©ì‹ìœ¼ë¡œ
        	flag: 'r' // ì½ê¸°
        }

        fs.readFile('/etc/passwd', options, ...)
        ```
    - `callback`: ì½œë°± í•¨ìˆ˜ ì „ë‹¬. íŒŒì¼ì„ ì½ê³  ë‚œ í›„ì— ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜
      - 2ê°€ì§€ ë§¤ê°œë³€ìˆ˜ ì¡´ì¬(`err` | `data`)
        - `err`: ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ ì•Šìœ¼ë©´ `err` = `null`
        - `data`: íŒŒì¼ ë‚´ìš© (ë¬¸ìì—´ | Buffer ê°ì²´ê°€ ì „ë‹¬)
        ```jsx
        fs.readFile("test.txt", "utf8", (err, data) => {
          if (err) {
            throw err;
          }
          console.log(data);
        });
        ```

- `fs.writeFile`: íŒŒì¼ ì €ì¥í•  ë•Œ

  ```jsx
  const fs = require("fs"); // file system module(fs) ë¶ˆëŸ¬ì˜¤ê¸°
  ```

- `3rd-party module`(ì„œë“œ íŒŒí‹° ëª¨ë“ˆ): í•´ë‹¹ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì—ì„œ ê³µì‹ì ìœ¼ë¡œ ì œê³µí•˜ëŠ” built-in ëª¨ë“ˆì´ ì•„ë‹Œ ëª¨ë“  ì™¸ë¶€ ëª¨ë“ˆ
  ```jsx
  // 3rd-party module download
  npm install underscore

  // ëª¨ë“ˆ ì‚¬ìš©
  const _ = require('underscore');
  ```

---

## â˜‘ï¸Â [Pair] Timer API

> `callback`, `Promise`, `async/await` êµ¬í˜„ ë°©ë²•ì„ ì´í•´í•˜ëŠ” í˜ì–´ í™œë™

**â°Â `new Promise()`ë¥¼ í†µí•´ ìƒì„±í•œ Promise ì¸ìŠ¤í„´ìŠ¤ì— ì¡´ì¬í•˜ëŠ” ë©”ì„œë“œ**

- `.then()`: í”„ë¡œë¯¸ìŠ¤ ì´í–‰ì‹œ ì½œë°± ë°˜í™˜
- `.catch()`: í”„ë¡œë¯¸ìŠ¤ ê±°ë¶€ì‹œ ì½œë°± ë°˜í™˜
- `.finally()`: í”„ë¡œë¯¸ìŠ¤ì˜ ì´í–‰/ê±°ë¶€ ì—¬ë¶€ì— ìƒê´€ì—†ì´ ì²˜ë¦¬ë  ê²½ìš° í•­ìƒ í˜¸ì¶œ

**â°Â í”„ë¡œë¯¸ìŠ¤ 3ê°€ì§€ ìƒíƒœ**

1. `Pending`(ëŒ€ê¸°): ì´í•´í•˜ì§€ë„, ê±°ë¶€í•˜ì§€ë„ ì•Šì€ ì´ˆê¸° ìƒíƒœ

   ```jsx
   new Promise();
   ```

2. `Fulfilled`(ì´í–‰): ì—°ì‚°ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œ

   ```jsx
   new Promise(function (resolve, reject) {
     resolve();
   });
   ```

3. `Rejected`(ê±°ë¶€): ì—°ì‚° ì‹¤íŒ¨

   ```jsx
   new Promise(function (resolve, reject) {
     reject();
   });
   ```

â°Â `await` í‚¤ì›Œë“œ ë‹¤ìŒì— ë“±ì¥í•˜ëŠ” í•¨ìˆ˜ ì‹¤í–‰ì€ `Promise` íƒ€ì…ì„ ë¦¬í„´í•œ ê²½ìš°ì—ë§Œ ì˜ë¯¸ê°€ ìˆìŒ

---

## â˜‘ï¸Â [Pair] fs module

> `callback`, `Promise`, `async/await`ë¥¼ í™œìš©í•˜ì—¬ `fs module`ì„ ì‚¬ìš©í•´ë³´ëŠ” í˜ì–´ í™œë™

<img width="777" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-05-31 á„‹á…©á„Œá…¥á†« 1 43 40" src="https://user-images.githubusercontent.com/64299610/171039930-df80017e-68f9-4512-a323-889b1a713a2a.png">

1. `fs module`ì„ `callback`ì„ í†µí•´ íŒŒì¼ ì •ë³´ ì½ì–´ì˜¤ê¸°

   ```jsx
   // fs module ë¶ˆì–´ì˜¤ê¸°
   const fs = require("fs");

   const getDataFromFile = function (filePath, callback) {
     // 'utf8' encoding í•˜ì§€ ì•Šìœ¼ë©´ í•œê¸€ ê¹¨ì§ í˜„ìƒ ë°œìƒ
     fs.readFile(filePath, "utf8", (err, data) => {
       if (err) {
         // ì—ëŸ¬ë‚œ ê²½ìš°
         callback(err, null); // ì—ëŸ¬ ë¶ˆëŸ¬ì˜´
       } else {
         // ì—ëŸ¬ë‚˜ì§€ ì•Šì€ ì¼ë°˜ì ì¸ ê²½ìš°
         callback(null, data); // íŒŒì¼ ì •ë³´ ì½ì–´ì˜¤ê¸°
       }
     });
   };

   module.exports = {
     getDataFromFile,
   };
   ```

2. `fs module`ì„ `Promise`ì„ í†µí•´ íŒŒì¼ ì •ë³´ ì½ì–´ì˜¤ê¸°

   ```jsx
   const fs = require("fs");

   const getDataFromFilePromise = (filePath) => {
     return new Promise((resolve, reject) => {
       fs.readFile(filePath, "utf8", (err, data) => {
         if (err) {
           reject(err);
         } else {
           // ì—ëŸ¬ê°€ ë‚˜ì§€ ì•Šì€ ê²½ìš° resolve ë©”ì†Œë“œ ì‹¤í–‰ -> íŒŒì¼ ì •ë³´ ì½ì–´ì˜´
           resolve(data);
         }
       });
     });
   };
   ```

3. 2ê°œì˜ json íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¨ í›„, í•©ì³ì„œ ë‘ ê°ì²´ê°€ ë‹´ê¸´ ë°°ì—´ ì¶œë ¥

   ```jsx
   const path = require("path");
   const { getDataFromFilePromise } = require("./02_promiseConstructor");

   const user1Path = path.join(__dirname, "files/user1.json");
   const user2Path = path.join(__dirname, "files/user2.json");

   const readAllUsersChaining = () => {
     let result = []; // ë¹ˆ ë°°ì—´ ì„ ì–¸

     return getDataFromFilePromise(user1Path) // ì²«ë²ˆì§¸ íŒŒì¼ ì •ë³´ ê°€ì ¸ì™€ì„œ
       .then((data) => {
         let data1 = JSON.parse(data); // json í˜•íƒœë¡œ ë³€í™˜
         result.push(data1); // ë¹ˆ ë°°ë³„ì— ì²«ë²ˆì§¸ íŒŒì¼ ê°ì²´ ë„£ì–´ì¤Œ
         return getDataFromFilePromise(user2Path); // ë‘ë²ˆì§¸ íŒŒì¼ ì •ë³´ ê°€ì ¸ì™€ì„œ
       })
       .then((data) => {
         let data2 = JSON.parse(data); // json í˜•íƒœë¡œ ë³€í™˜
         result.push(data2); // ì²«ë²ˆì§¸ íŒŒì¼ ê°ì²´ê°€ ë“¤ì–´ê°„ ë°°ì—´ì— ë‘ë²ˆì§¸ íŒŒì¼ ê°ì²´ ë„£ì–´ì¤Œ
         return result; // ì²«ë²ˆì§¸, ë‘ë²ˆì§¸ íŒŒì¼ ê°ì²´ê°€ ë“¤ì–´ê°„ ë°°ì—´ ë°˜í™˜
       });
   };

   // JSON.parse() ì „ì˜ íŒŒì¼ ì •ë³´ì—ëŠ” key&value ëª¨ë‘ ë¬¸ìì—´ í˜•íƒœë¡œ ì €ì¥ë˜ì–´ ìˆìŒ
   // JSON.parse() í›„ì˜ íŒŒì¼ ê°ì²´ì—” keyë¥¼ ê°ì‹¸ê³  ìˆëŠ” ""ì´ ì œê±°ëœ í˜•íƒœë¡œ ë³€í™˜í•´ì¤Œ
   ```

4. `Promise.all()` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ 3ë²ˆì§¸ ì¶œë ¥ ê²°ê³¼ì™€ ê°™ë„ë¡ êµ¬í˜„

   ```jsx
   const readAllUsers = () => {
     return Promise.all([
       // ì „ë‹¬ì¸ìë¥¼ ë°°ì—´ í˜•íƒœë¡œ ë°›ìŒ
       getDataFromFilePromise(user1Path),
       getDataFromFilePromise(user2Path),
     ]).then((data) => data.map((el) => JSON.parse(el)));
   };
   ```

   **â°Â `Promise.all()`**

   > - ì£¼ì–´ì§„ ëª¨ë“  í”„ë¡œë¯¸ìŠ¤ë¥¼ ì´í–‰í•˜ê±°ë‚˜, í•œ í”„ë¡œë¯¸ìŠ¤ê°€ ê±°ë¶€ë  ë•Œê¹Œì§€ ëŒ€ê¸°í•˜ëŠ” ìƒˆë¡œìš´ í”„ë¡œë¯¸ìŠ¤ë¥¼ ë°˜í™˜

   - ë™ì‹œì— 2ê°œ ì´ìƒì˜ Promise ìš”ì²­ì„ í•œêº¼ë²ˆì— ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜
   - Promise.allì˜ ì „ë‹¬ì¸ìëŠ” ë°°ì—´ í˜•íƒœ
     >

5. `async/await` ì‚¬ìš©í•˜ì—¬ ìœ„ì™€ ê°™ì€ ì¶œë ¥ ê²°ê³¼ê°€ ë‚˜ì˜¤ë„ë¡ êµ¬í˜„

   ```jsx
   const readAllUsersAsyncAwait = async () => {
     let result = [];
     let user1 = await getDataFromFilePromise(user1Path);
     let user2 = await getDataFromFilePromise(user2Path);
     let data1 = JSON.parse(user1);
     let data2 = JSON.parse(user2);
     result.push(data1, data2);
     return result;
   };
   ```
